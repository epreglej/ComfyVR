import{bK as Ct}from"./CsffHjsU.js";function At(X,O){for(var x=0;x<O.length;x++){const R=O[x];if(typeof R!="string"&&!Array.isArray(R)){for(const p in R)if(p!=="default"&&!(p in X)){const w=Object.getOwnPropertyDescriptor(R,p);w&&Object.defineProperty(X,p,w.get?w:{enumerable:!0,get:()=>R[p]})}}}return Object.freeze(Object.defineProperty(X,Symbol.toStringTag,{value:"Module"}))}var dt={exports:{}};(function(X){(function(O){X.exports?(O.default=O,X.exports=O):O(typeof Highcharts<"u"?Highcharts:void 0)})(function(O){var x=O?O._modules:{};function R(p,w,f,W){p.hasOwnProperty(w)||(p[w]=W.apply(null,f),typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:w,module:p[w]}})))}R(x,"Extensions/DownloadURL.js",[x["Core/Globals.js"]],function(p){let{isSafari:w,win:f,win:{document:W}}=p,J=f.URL||f.webkitURL||f;function Q(y){let H=y.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(H&&H.length>3&&f.atob&&f.ArrayBuffer&&f.Uint8Array&&f.Blob&&J.createObjectURL){let V=f.atob(H[3]),k=new f.ArrayBuffer(V.length),v=new f.Uint8Array(k);for(let B=0;B<v.length;++B)v[B]=V.charCodeAt(B);return J.createObjectURL(new f.Blob([v],{type:H[1]}))}}return{dataURLtoBlob:Q,downloadURL:function(y,H){let V=f.navigator,k=W.createElement("a");if(typeof y!="string"&&!(y instanceof String)&&V.msSaveOrOpenBlob){V.msSaveOrOpenBlob(y,H);return}y=""+y;let v=/Edge\/\d+/.test(V.userAgent);if((w&&typeof y=="string"&&y.indexOf("data:application/pdf")===0||v||y.length>2e6)&&!(y=Q(y)||""))throw Error("Failed to convert to blob");if(k.download!==void 0)k.href=y,k.download=H,W.body.appendChild(k),k.click(),W.body.removeChild(k);else try{if(!f.open(y,"chart"))throw Error("Failed to open window")}catch{f.location.href=y}}}}),R(x,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:`
`},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0,showExportInProgress:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table",exportInProgress:"Exporting..."}}}),R(x,"Extensions/ExportData/ExportData.js",[x["Core/Renderer/HTML/AST.js"],x["Core/Defaults.js"],x["Extensions/DownloadURL.js"],x["Extensions/ExportData/ExportDataDefaults.js"],x["Core/Globals.js"],x["Core/Utilities.js"]],function(p,w,f,W,J,Q){let{getOptions:y,setOptions:H}=w,{downloadURL:V}=f,{doc:k,win:v}=J,{addEvent:B,defined:pt,extend:st,find:ut,fireEvent:tt,isNumber:ft,pick:F}=Q;function nt(o){var a;let s=!!((a=this.options.exporting)!=null&&a.showExportInProgress),e=v.requestAnimationFrame||setTimeout;e(()=>{s&&this.showLoading(this.options.lang.exportInProgress),e(()=>{try{o.call(this)}finally{s&&this.hideLoading()}})})}function mt(){nt.call(this,()=>{let o=this.getCSV(!0);V(lt(o,"text/csv")||"data:text/csv,\uFEFF"+encodeURIComponent(o),this.getFilename()+".csv")})}function xt(){nt.call(this,()=>{let o='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";V(lt(o,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+v.btoa(unescape(encodeURIComponent(o))),this.getFilename()+".xls")})}function gt(o){let s="",e=this.getDataRows(),a=this.options.exporting.csv,r=F(a.decimalPoint,a.itemDelimiter!==","&&o?1.1.toLocaleString()[1]:"."),i=F(a.itemDelimiter,r===","?";":","),l=a.lineDelimiter;return e.forEach((n,u)=>{let c="",T=n.length;for(;T--;)typeof(c=n[T])=="string"&&(c=`"${c}"`),typeof c=="number"&&r!=="."&&(c=c.toString().replace(".",r)),n[T]=c;n.length=e.length?e[0].length:0,s+=n.join(i),u<e.length-1&&(s+=l)}),s}function bt(o){let s,e,a=this.hasParallelCoordinates,r=this.time,i=this.options.exporting&&this.options.exporting.csv||{},l=this.xAxis,n={},u=[],c=[],T=[],q=this.options.lang.exportData,G=q.categoryHeader,g=q.categoryDatetimeHeader,d=function(t,D,S){if(i.columnHeaderFormatter){let L=i.columnHeaderFormatter(t,D,S);if(L!==!1)return L}return t?t.bindAxes?o?{columnTitle:S>1?D:t.name,topLevelColumnTitle:t.name}:t.name+(S>1?" ("+D+")":""):t.options.title&&t.options.title.text||(t.dateTime?g:G):G},b=function(t,D,S){let L={},z={};return D.forEach(function(P){let _=(t.keyToAxis&&t.keyToAxis[P]||P)+"Axis",K=ft(S)?t.chart[_][S]:t[_];L[P]=K&&K.categories||[],z[P]=K&&K.dateTime}),{categoryMap:L,dateTimeValueAxisMap:z}},M=function(t,D){let S=t.pointArrayMap||["y"];return t.data.some(L=>L.y!==void 0&&L.name)&&D&&!D.categories&&t.exportKey!=="name"?["x",...S]:S},h=[],E,A,j,C=0,N,I;for(N in this.series.forEach(function(t){let D=t.options.keys,S=t.xAxis,L=D||M(t,S),z=L.length,P=!t.requireSorting&&{},_=l.indexOf(S),K=b(t,L),ct,U;if(t.options.includeInDataExport!==!1&&!t.options.isInternal&&t.visible!==!1){for(ut(h,function(it){return it[0]===_})||h.push([_,C]),U=0;U<z;)j=d(t,L[U],L.length),T.push(j.columnTitle||j),o&&c.push(j.topLevelColumnTitle||j),U++;ct={chart:t.chart,autoIncrement:t.autoIncrement,options:t.options,pointArrayMap:t.pointArrayMap,index:t.index},t.options.data.forEach(function(it,et){let m,rt,ot,Y={series:ct};a&&(K=b(t,L,et)),t.pointClass.prototype.applyOptions.apply(Y,[it]);let at=t.data[et]&&t.data[et].name;if(m=(Y.x??"")+","+at,U=0,(!S||t.exportKey==="name"||!a&&S&&S.hasNames&&at)&&(m=at),P&&(P[m]&&(m+="|"+et),P[m]=!0),n[m]){let $=`${m},${n[m].pointers[t.index]}`,Z=m;n[m].pointers[t.index]&&(n[$]||(n[$]=[],n[$].xValues=[],n[$].pointers=[]),m=$),n[Z].pointers[t.index]+=1}else{n[m]=[],n[m].xValues=[];let $=[];for(let Z=0;Z<t.chart.series.length;Z++)$[Z]=0;n[m].pointers=$,n[m].pointers[t.index]=1}for(n[m].x=Y.x,n[m].name=at,n[m].xValues[_]=Y.x;U<z;)ot=Y[rt=L[U]],n[m][C+U]=F(K.categoryMap[rt][ot],K.dateTimeValueAxisMap[rt]?r.dateFormat(i.dateFormat,ot):null,ot),U++}),C+=U}}),n)Object.hasOwnProperty.call(n,N)&&u.push(n[N]);for(A=o?[c,T]:[T],C=h.length;C--;)s=h[C][0],e=h[C][1],E=l[s],u.sort(function(t,D){return t.xValues[s]-D.xValues[s]}),I=d(E),A[0].splice(e,0,I),o&&A[1]&&A[1].splice(e,0,I),u.forEach(function(t){let D=t.name;E&&!pt(D)&&(E.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),D=r.dateFormat(i.dateFormat,t.x)):D=E.categories?F(E.names[t.x],E.categories[t.x],t.x):t.x),t.splice(e,0,D)});return tt(this,"exportData",{dataRows:A=A.concat(u)}),A}function yt(o){let s=e=>{if(!e.tagName||e.tagName==="#text")return e.textContent||"";let a=e.attributes,r=`<${e.tagName}`;return a&&Object.keys(a).forEach(i=>{let l=a[i];r+=` ${i}="${l}"`}),r+=">"+(e.textContent||""),(e.children||[]).forEach(i=>{r+=s(i)}),r+=`</${e.tagName}>`};return s(this.getTableAST(o))}function Dt(o){let s=0,e=[],a=this.options,r=o?1.1.toLocaleString()[1]:".",i=F(a.exporting.useMultiLevelHeaders,!0),l=this.getDataRows(i),n=i?l.shift():null,u=l.shift(),c=function(g,d){let b=g.length;if(d.length!==b)return!1;for(;b--;)if(g[b]!==d[b])return!1;return!0},T=function(g,d,b,M){let h=F(M,""),E="highcharts-text"+(d?" "+d:"");return typeof h=="number"?(h=h.toString(),r===","&&(h=h.replace(".",r)),E="highcharts-number"):M||(E="highcharts-empty"),{tagName:g,attributes:b=st({class:E},b),textContent:h}};a.exporting.tableCaption!==!1&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:F(a.exporting.tableCaption,a.title.text?a.title.text:"Chart")});for(let g=0,d=l.length;g<d;++g)l[g].length>s&&(s=l[g].length);e.push(function(g,d,b){let M=[],h=0,E=b||d&&d.length,A,j=0,C;if(i&&g&&d&&!c(g,d)){let N=[];for(;h<E;++h)if((A=g[h])===g[h+1])++j;else if(j)N.push(T("th","highcharts-table-topheading",{scope:"col",colspan:j+1},A)),j=0;else{A===d[h]?a.exporting.useRowspanHeaders?(C=2,delete d[h]):(C=1,d[h]=""):C=1;let I=T("th","highcharts-table-topheading",{scope:"col"},A);C>1&&I.attributes&&(I.attributes.valign="top",I.attributes.rowspan=C),N.push(I)}M.push({tagName:"tr",children:N})}if(d){let N=[];for(h=0,E=d.length;h<E;++h)d[h]!==void 0&&N.push(T("th",null,{scope:"col"},d[h]));M.push({tagName:"tr",children:N})}return{tagName:"thead",children:M}}(n,u,Math.max(s,u.length)));let q=[];l.forEach(function(g){let d=[];for(let b=0;b<s;b++)d.push(T(b?"td":"th",null,b?{}:{scope:"row"},g[b]));q.push({tagName:"tr",children:d})}),e.push({tagName:"tbody",children:q});let G={tree:{tagName:"table",id:`highcharts-data-table-${this.index}`,children:e}};return tt(this,"aftergetTableAST",G),G.tree}function wt(){this.toggleDataTable(!1)}function vt(o){let s=(o=F(o,!this.isDataTableVisible))&&!this.dataTableDiv;if(s&&(this.dataTableDiv=k.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){let l=this.dataTableDiv.style,n=l.display;l.display=o?"block":"none",o?(this.dataTableDiv.innerHTML=p.emptyHTML,new p([this.getTableAST()]).addToDOM(this.dataTableDiv),tt(this,"afterViewData",{element:this.dataTableDiv,wasHidden:s||n!==l.display})):tt(this,"afterHideData")}this.isDataTableVisible=o;let e=this.exportDivElements,a=this.options.exporting,r=a&&a.buttons&&a.buttons.contextButton.menuItems,i=this.options.lang;if(a&&a.menuItemDefinitions&&i&&i.viewData&&i.hideData&&r&&e){let l=e[r.indexOf("viewData")];l&&p.setElementHTML(l,this.isDataTableVisible?i.hideData:i.viewData)}}function Tt(){this.toggleDataTable(!0)}function lt(o,s){let e=v.navigator,a=v.URL||v.webkitURL||v;try{if(e.msSaveOrOpenBlob&&v.MSBlobBuilder){let r=new v.MSBlobBuilder;return r.append(o),r.getBlob("image/svg+xml")}return a.createObjectURL(new v.Blob(["\uFEFF"+o],{type:s}))}catch{}}function Et(){let o=this,s=o.dataTableDiv,e=(r,i)=>r.children[i].textContent,a=(r,i)=>(l,n)=>{let u,c;return u=e(i?l:n,r),c=e(i?n:l,r),u===""||c===""||isNaN(u)||isNaN(c)?u.toString().localeCompare(c):u-c};if(s&&o.options.exporting&&o.options.exporting.allowTableSorting){let r=s.querySelector("thead tr");r&&r.childNodes.forEach(i=>{let l=i.closest("table");i.addEventListener("click",function(){let n=[...s.querySelectorAll("tr:not(thead tr)")],u=[...i.parentNode.children];n.sort(a(u.indexOf(i),o.ascendingOrderInTable=!o.ascendingOrderInTable)).forEach(c=>{l.appendChild(c)}),u.forEach(c=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(T=>{c.classList.contains(T)&&c.classList.remove(T)})}),i.classList.add(o.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function St(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}function Lt(){var o;(o=this.dataTableDiv)==null||o.remove()}return{compose:function(o,s){let e=o.prototype;if(!e.getCSV){let a=y().exporting;B(o,"afterViewData",Et),B(o,"render",St),B(o,"destroy",Lt),e.downloadCSV=mt,e.downloadXLS=xt,e.getCSV=gt,e.getDataRows=bt,e.getTable=yt,e.getTableAST=Dt,e.hideData=wt,e.toggleDataTable=vt,e.viewData=Tt,a&&(st(a.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){nt.call(this,this.toggleDataTable)}}}),a.buttons&&a.buttons.contextButton.menuItems&&a.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),H(W);let{arearange:r,gantt:i,map:l,mapbubble:n,treemap:u,xrange:c}=s.types;r&&(r.prototype.keyToAxis={low:"y",high:"y"}),i&&(i.prototype.exportKey="name",i.prototype.keyToAxis={start:"x",end:"x"}),l&&(l.prototype.exportKey="name"),n&&(n.prototype.exportKey="name"),u&&(u.prototype.exportKey="name"),c&&(c.prototype.keyToAxis={x2:"x"})}}}}),R(x,"masters/modules/export-data.src.js",[x["Core/Globals.js"],x["Extensions/DownloadURL.js"],x["Extensions/ExportData/ExportData.js"]],function(p,w,f){return p.dataURLtoBlob=p.dataURLtoBlob||w.dataURLtoBlob,p.downloadURL=p.downloadURL||w.downloadURL,f.compose(p.Chart,p.Series),p})})})(dt);var ht=dt.exports;const Ot=Ct(ht),kt=At({__proto__:null,default:Ot},[ht]);export{kt as e};
